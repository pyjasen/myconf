#!/usr/bin/env python
# coding=utf-8
import sys
from Crypto.Cipher import AES
from binascii import b2a_hex, a2b_hex
import os
from Crypto import Random
class AESUtil:
    __BLOCK_SIZE_16 = BLOCK_SIZE_16 = AES.block_size
    def_key = "abcdefg123456!@#"

    @staticmethod
    def encryt(str, key):
        cipher = AES.new(key, AES.MODE_ECB, key)
        x = AESUtil.__BLOCK_SIZE_16 - (len(str) % AESUtil.__BLOCK_SIZE_16)
        if x != 0:
            str = str + chr(x) * x
        msg = cipher.encrypt(str)
        msg = b2a_hex(msg)
        return msg

    @staticmethod
    def decrypt(enStr, key):
        cipher = AES.new(key, AES.MODE_ECB)
        enStr += (len(enStr) % 4) * "="
        decryptByts = a2b_hex(enStr)
        msg = cipher.decrypt(decryptByts)
        paddingLen = ord(msg[len(msg) - 1])
        return msg[0:-paddingLen]

if __name__ == '__main__':
    print AESUtil.encryt('111', "abcdefg123456!@#")
    print AESUtil.decrypt("97439F820CADA84BBF2680E9AF16748C62A8F3D1F4A634718588F89D2BE3E970EA03807B18B8F80BC2BF5782134C7506020D9CF57959C544C53771943DF6AAA4A11652D38DBBEF78543E61C50B9C1E9C7C495D0D81F69623376F765A3FEFBA58DD3ED67C75235CD6C3BE3F582AF1674C34C58C654F9BE7039A2218530EA3A98DC67E3106E53D875E6EB6E2BBA4378F3AB8EF27F447869CAF3A3D8245B7F1B5DD63EABEE903007E1EF654FF0ACE8548747E6AD27030C6ECA7D7D8754FC0D1F115EE9BAD63A11E5670A32D717DB9B81A533B5B89F3458B584AF2150574C1D15631E005294C7F14AF7C5C4A176C049C18F506EF55F76FB9577547831134B9A8AD6E010384781ECC6BE6305688F8F370A42AC802C0937A37D5F583780758D5704A93AAA1E0E59B36C84774EDAA726CFE45884EF54FF4CAB814C262D080AA64D0C656C9ABEDD634150E6A8825F2D1BA342BE82BA2A906FB6816A0C5B2DDA217DA9750B165CED570E5786E650E7A52253C90194259B0B348C45A27AA374CBB4D89B1245230D37BE95F6A5AA7C8D96B732CD80C7092E8B9181274FFD22A60DBAD43624697A58D8E9642D28E1053370932DC2EFD3DC3F54759FDE82C7D2C42EF880AA2B06C78EFF56E852FF7A36B272B17055BFAD834686FD00D1CA64D281F4A840EA88437D5B1A64304F63EC9A7353FB806D2A666CCC80DAB3514069119E4B30D24D8C72A85F242D94C2596B17EB4656DA44ACD69DC96064B8B45858B8E7EFD0E9970219C9685EB24270FDE1393279FE9F2EB0ACF7E0AE1F264E329C4EA1BC29F0F0116BC5256C0D52336242A3AE750248E01B499EC7F14E84A7039D9C2A701FFFB2224", "abcdefg123456!@#")
